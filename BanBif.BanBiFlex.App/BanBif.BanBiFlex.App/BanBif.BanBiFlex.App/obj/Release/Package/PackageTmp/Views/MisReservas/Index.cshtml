<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="content-type" content="text/plain; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <title>BanBiflex | Separación de Sitios</title>

    <meta name="description" content="overview &amp; stats" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

    <!-- bootstrap & fontawesome -->
    <link rel="stylesheet" href="~/Library/assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/Library/assets/font-awesome/4.5.0/css/font-awesome.min.css" />
    <!-- text fonts -->
    <link rel="stylesheet" href="~/Library/assets/css/fonts.googleapis.com.css" />

    <!-- ace styles -->
    <link rel="stylesheet" href="~/Library/assets/css/ace.min.css" class="ace-main-stylesheet" id="main-ace-style" />
    <link rel="stylesheet" href="~/Library/assets/css/ace-skins.min.css" />
    <link rel="stylesheet" href="~/Library/assets/css/ace-rtl.min.css" />
    <link href="~/Library/css/bootstrap-datepicker/bootstrap-datepicker.min.css" rel="stylesheet" />
    <!-- ace settings handler -->
    @*<link href="Library/js/dataTables/dataTables.bootstrap.css" rel="stylesheet" />*@


    <link href="~/Library/css/alertifyjs/alertify.css" rel="stylesheet" />
    <link href="~/Library/css/alertifyjs/default.css" rel="stylesheet" />

    <script src="~/Library/assets/js/ace-extra.min.js"></script>
    <script src="~/Library/assets/js/jquery-2.1.4.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title> </title>

    <style>
        /* styles unrelated to zoom */
        * {
            border: 0;
            margin: 0;
            padding: 0;
        }

        p {
            position: absolute;
            top: 3px;
            right: 28px;
            color: #555;
            font: bold 13px/1 sans-serif;
        }

        /* these styles are for the demo, but are not required for the plugin */
        .zoom {
            display: inline-block;
            position: relative;
        }

            /* magnifying glass icon */
            .zoom:after {
                content: '';
                display: block;
                width: 33px;
                height: 33px;
                position: absolute;
                top: 0;
                right: 0;
                background: url('../../Content/ImagenesPiso/icon.png');
            }

            .zoom img {
                display: block;
            }

                .zoom img::selection {
                    background-color: transparent;
                }
    </style>

    @*<script src='http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js'></script>*@

    <script src="~/Library/js/jquery.zoom.js"></script>
    


    <!-- CUSTOM CSS -->

    <script src="~/Library/js/jquery.blockUI.js"></script>

    <style>
        .sidebar {
            width: 220px;
            float: left;
            position: static;
            padding-left: 0;
            padding-right: 0;
        }

            .sidebar + .main-content {
                margin-left: 220px;
            }

        .input-sm {
            height: 26px;
            line-height: 1.5;
        }

        select.input-sm {
            height: 26px;
            line-height: 30px;
        }

        .form-group-sm .form-control + .form-control-feedback, .input-group-sm + .form-control-feedback, .input-sm + .form-control-feedback {
            width: 10px;
            height: 30px;
            line-height: 30px;
        }

        td.details-control {
            background: url('../../Library/img/details_open.png') no-repeat center center;
            cursor: pointer;
        }

        tr.shown td.details-control {
            background: url('../../Library/img/details_close.png') no-repeat center center;
        }
    </style>
</head>

<body class="no-skin">

    <div id="navbar" class="navbar navbar-default ace-save-state" style="background: #20a6ff !important">
        <div class="navbar-container ace-save-state" id="navbar-container">
            <button type="button" class="navbar-toggle menu-toggler pull-left" id="menu-toggler" data-target="#sidebar">
                <span class="sr-only">Toggle sidebar</span>

                <span class="icon-bar"></span>

                <span class="icon-bar"></span>

                <span class="icon-bar"></span>
            </button>

            <div class="navbar-header pull-left">

                <a class="navbar-brand brand-logo" href="#">
                    <img src="~/Library/assets/images/banbif/logo_banbif_blanco.png" style="margin-left: 40px; width: 120px" alt="logo">
                </a>
            </div>

            <div class="navbar-buttons navbar-header pull-right" role="navigation">
                <ul class="nav ace-nav">
                    <li class="light-blue dropdown-modal">
                        <a ID="btnCerrarSesion" href="#" onclick="CerrarSesion()">
                            <i class="ace-icon fa fa-power-off"></i>
                            Cerrar Sesión
                        </a>

                      

                    </li>
                </ul>
            </div>

        </div><!-- /.navbar-container -->
    </div>

    <div class="main-container ace-save-state" id="main-container">
        <script type="text/javascript">
            try { ace.settings.loadState('main-container') } catch (e) { }
        </script>


        <div id="sidebar" class="sidebar responsive ace-save-state">
            <script type="text/javascript">
                try { ace.settings.loadState('sidebar') } catch (e) { }
            </script>

            <ul class="nav nav-list">
                <li>
                    <a href="/Principal">
                        <i class="menu-icon fa  fa-check -o" style="font-size:15px;"></i>
                        Reserva de Espacio de Trabajo
                    </a>
                </li>
                <li id="liParametro">
                    <a href="/MisReservas">
                        <i class="menu-icon fa  fa-table -o" style="font-size:15px;"></i>
                        Mis Reservas
                    </a>
                </li>
                @*<li>
                    <a href="/SalaReuniones">
                        <i class="menu-icon fa  fa-check -o" style="font-size:15px;"></i>
                        Reserva de Espacio de Trabajo
                    </a>
                </li>*@

            </ul><!-- /.nav-list -->
        </div>


        <div id="divMainContent" class="main-content">
            <div class="main-content-inner">
                <div id="process-data-loader" class="notdisplay">
                    <img src="~/Library/img/ajax-loader.gif" alt="" />
                    <label>Cargando Información...</label>
                </div>
                <div class="page-content">
                    <div class="row">
                        <div class="col-sm-9">
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group">
                                        <div class="page-header">
                                            <h4><b>MIS RESERVAS</b></h4>
                                        </div>
                                        <div class="page-content">

                                            <div class="row">
                                                <div class="col-sm-12">
                                                    <div class="panel-aux panel panel-default">

                                                        <table class="table">
                                                            <thead>
                                                                <tr>
                                                                    <td></td>                                                            
                                                                    <td>Fecha Reserva  </td>
                                                                    <td>Piso </td>
                                                                    <td>Sitio</td>
                                                                    <td>Estacionamiento</td>
                                                                    <td>Comentario</td>
                                                                    <td>Estado</td>
                                                                </tr>
                                                            </thead>
                                                            <tbody id="bodyTable"></tbody>
                                                        </table>

                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>

                </div><!-- /.page-content -->
            </div>
        </div><!-- /.main-content -->

    </div><!-- /.main-container -->
    <!-- basic scripts -->
    <!--[if !IE]> -->
    <!--[if IE]>
    <script src="assets/js/jquery-1.11.3.min.js"></script>
    <![endif]-->
    <script type="text/javascript">
        if ('ontouchstart' in document.documentElement) document.write("<script src='~/Library/assets/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
    </script>
    <script src="~/Library/assets/js/bootstrap.min.js"></script>

    <script src="~/Library/js/bootstrap.min.js"></script>
    <script src="~/Library/js/sweetalert2.min.js"></script>
    <script type="text/javascript">

        function Cargando() {
            $('#process-data-loader').show();
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.0/sweetalert.min.js"></script>
    <link href="http://tristanedwards.me/u/SweetAlert/lib/sweet-alert.css" rel="stylesheet" />



</body>
</html>

<script>

    var FechaMin;
    var FechaMax;
    var IdSitio = 0;
    var flag = 1;
    var formaTransporte;
    var flagAsiento = 0;

    $(document).ready(function () {
        sessionStorage.setItem("APP", "@ViewBag.App");
     
        if (sessionStorage.getItem("USERID") < 1 || sessionStorage.getItem("USERID") == null) {
            window.location.href = sessionStorage.APP + "/Home";
        }

        var oBEMisReservasRequest = {};
        oBEMisReservasRequest.UsuarioId = sessionStorage.getItem("USERID");
        $.ajax({
            url: sessionStorage.APP + '/MisReservas/ListarMisReservas',
            type: "POST",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            processData: true,
            data: JSON.stringify(oBEMisReservasRequest),
            success: function (responseReservas) {
                console.log(responseReservas);
                if (responseReservas != null) {
                    var dataHtml = "";
                    $('#process-data-loader').hide();
                    $.each(responseReservas.data, function (index, item) {

                        dataHtml += '<tr>';
                        if (item.Estado == "Reservado") {
                            dataHtml += '<td><a href = "#" onclick = "AnularReserva(' + item.Id + ')">Anular Reserva</td>';
                        }
                        else {
                            dataHtml += '<td></td>';
                        }
                       
                        dataHtml += '<td>' + item.Fecha + '</td>';
                        dataHtml += '<td>' + item.Piso + '</td>';
                        dataHtml += '<td>' + item.Sitio + '</td>';
                        if (item.Estacionamiento == null) {
                            dataHtml += '<td> No </td>';
                        }
                        else {
                            dataHtml += '<td> Si </td>';
                        }
                        dataHtml += '<td>' + item.Comentario + '</td>';
                        dataHtml += '<td>' + item.Estado + '</td>';
                        dataHtml += '</tr>';
                    });

                    $('#bodyTable').html(dataHtml);
                }
                else {
                    alert("No se encontraron resultados.");
                }
            },
            failure: function (msg) {
                console.log(msg);
            },
            error: function (xhr, status, error) {
                console.log(error);
            },
            complete: function () {
            }
        });
    });
</script>

<script type="text/javascript">

    function CerrarSesion() {
        window.location.href = sessionStorage.APP;
    }

    function AnularReserva(idReserva) {
        
        if (window.confirm("¿Está seguro de anular la reserva?")) {
            $('#process-data-loader').show();
            var oBEMisReservasRequest = {};
            oBEMisReservasRequest.IdReserva = idReserva;
            oBEMisReservasRequest.Estado = "Anulada";
            $.ajax({
                url: sessionStorage.APP + '/MisReservas/ActualizarEstadoReserva',
                type: "POST",
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                processData: true,
                data: JSON.stringify(oBEMisReservasRequest),
                success: function (responseReservas) {
                    console.log(responseReservas);
                    if (responseReservas.dat != 0) {
                        $('#process-data-loader').hide();
                        swal("Reserva Anulada correctamente.");
                        window.location.href = sessionStorage.APP + "/MisReservas";
                    }
                    else {
                        $('#process-data-loader').hide();
                        
                        swal("No se pudo actualizar la reserva.");
                    }
                },
                failure: function (msg) {
                    console.log(msg);
                },
                error: function (xhr, status, error) {
                    console.log(error);
                },
                complete: function () {
                }
            });
        }
    }


</script>